Final Project
================
Po-Sheng Lee

``` r
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, include = FALSE)

library(quantmod)
```

    ## Loading required package: xts

    ## Loading required package: zoo

    ## 
    ## Attaching package: 'zoo'

    ## The following objects are masked from 'package:base':
    ## 
    ##     as.Date, as.Date.numeric

    ## Loading required package: TTR

    ## Version 0.4-0 included new data defaults. See ?getSymbols.

``` r
library(MTS)
```

    ## 
    ## Attaching package: 'MTS'

    ## The following object is masked from 'package:TTR':
    ## 
    ##     VMA

``` r
library(tidyverse)
```

    ## ─ Attaching packages ────────────────────────────────── tidyverse 1.2.1 ─

    ## ✔ ggplot2 3.1.0       ✔ purrr   0.3.0  
    ## ✔ tibble  2.0.1       ✔ dplyr   0.8.0.1
    ## ✔ tidyr   0.8.2       ✔ stringr 1.4.0  
    ## ✔ readr   1.3.1       ✔ forcats 0.4.0

    ## ─ Conflicts ──────────────────────────────────── tidyverse_conflicts() ─
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::first()  masks xts::first()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ✖ dplyr::last()   masks xts::last()

``` r
library(magrittr)
```

    ## 
    ## Attaching package: 'magrittr'

    ## The following object is masked from 'package:purrr':
    ## 
    ##     set_names

    ## The following object is masked from 'package:tidyr':
    ## 
    ##     extract

``` r
library(fGarch)
```

    ## Loading required package: timeDate

    ## Loading required package: timeSeries

    ## 
    ## Attaching package: 'timeSeries'

    ## The following object is masked from 'package:zoo':
    ## 
    ##     time<-

    ## Loading required package: fBasics

    ## 
    ## Attaching package: 'fBasics'

    ## The following object is masked from 'package:TTR':
    ## 
    ##     volatility

``` r
library(fUnitRoots)
library(urca)
```

    ## 
    ## Attaching package: 'urca'

    ## The following objects are masked from 'package:fUnitRoots':
    ## 
    ##     punitroot, qunitroot, unitrootTable

``` r
library(stargazer)
```

    ## 
    ## Please cite as:

    ##  Hlavac, Marek (2018). stargazer: Well-Formatted Regression and Summary Statistics Tables.

    ##  R package version 5.2.2. https://CRAN.R-project.org/package=stargazer

``` r
source("Corner.R")
```

Time Series analysis of trade from East Asia and inflation
==========================================================

Below is the plot and model of US's import from China, Taiwan HK, JP and Kr. We take the log transformation of the import value. Error Correction model with cointergration series as wess as Seasonal Model are reported here. Seasonal Model with order (0,1,3) , sorder(0, 1, 1) and s = 12 is preferred, for its lower aic and bic.

![](FinalProject_files/figure-markdown_github/report%20asia%20trade-1.png)

    ## 
    ## ###################### 
    ## # Johansen-Procedure # 
    ## ###################### 
    ## 
    ## Test type: trace statistic , without linear trend and constant in cointegration 
    ## 
    ## Eigenvalues (lambda):
    ## [1]  2.394373e-01  1.064098e-01  5.595617e-02  2.812954e-02  1.512225e-02
    ## [6] -2.189976e-18
    ## 
    ## Values of teststatistic and critical values of test:
    ## 
    ##            test 10pct  5pct  1pct
    ## r <= 4 |   6.25  7.52  9.24 12.97
    ## r <= 3 |  17.95 17.85 19.96 24.60
    ## r <= 2 |  41.55 32.00 34.91 41.07
    ## r <= 1 |  87.68 49.65 53.12 60.16
    ## r = 0  | 199.90 71.86 76.07 84.45
    ## 
    ## Eigenvectors, normalised to first column:
    ## (These are the cointegration relations)
    ## 
    ##              imp_china.l1  imp_tw.l1   imp_hk.l1    imp_jp.l1   imp_kr.l1
    ## imp_china.l1     1.000000   1.000000   1.0000000   1.00000000  1.00000000
    ## imp_tw.l1        4.009407 -26.056302 -10.7374006 -35.49326495 -0.89151293
    ## imp_hk.l1        1.964347   8.947939  -0.4177084   0.06785429 -0.03468064
    ## imp_jp.l1       -8.025296   7.965133  -4.4171159 -16.39355544  0.71733454
    ## imp_kr.l1       -1.304560   8.669795   1.7221563  23.09839021 -2.36132892
    ## constant        13.381042  -1.498707  46.0780900 100.86817836  4.49691938
    ##                 constant
    ## imp_china.l1   1.0000000
    ## imp_tw.l1      0.1950372
    ## imp_hk.l1     -1.9252072
    ## imp_jp.l1     -4.5812609
    ## imp_kr.l1     13.8097717
    ## constant     -25.6292552
    ## 
    ## Weights W:
    ## (This is the loading matrix)
    ## 
    ##             imp_china.l1     imp_tw.l1   imp_hk.l1     imp_jp.l1
    ## imp_china.d  -0.03014430 -0.0001405338 0.011023499 -0.0007068009
    ## imp_tw.d     -0.02199965  0.0010814364 0.008530865  0.0003552113
    ## imp_hk.d     -0.08418840 -0.0231165265 0.007777405  0.0009071998
    ## imp_jp.d      0.03828841 -0.0034312661 0.006890306  0.0004145528
    ## imp_kr.d     -0.01069176 -0.0024139732 0.007542188 -0.0005896727
    ##                imp_kr.l1      constant
    ## imp_china.d -0.010612518  1.124473e-16
    ## imp_tw.d     0.003357247  2.217831e-16
    ## imp_hk.d    -0.008945971  1.431022e-16
    ## imp_jp.d     0.002333057 -1.699960e-16
    ## imp_kr.d     0.011060220 -2.846121e-18

    ## Equation:  1  npar =  30 
    ## Equation:  2  npar =  35 
    ## Equation:  3  npar =  28 
    ## Equation:  4  npar =  29 
    ## Equation:  5  npar =  26 
    ## alpha:  
    ##         [,1]     [,2]    [,3]
    ## [1,]  0.0000  0.00000 0.00922
    ## [2,]  0.0000  0.00000 0.00914
    ## [3,] -0.0250  0.00000 0.00000
    ## [4,]  0.0268 -0.00199 0.00504
    ## [5,]  0.0000  0.00000 0.00453
    ## standard error 
    ##         [,1]    [,2]    [,3]
    ## [1,] 1.00000 1.00000 0.00258
    ## [2,] 1.00000 1.00000 0.00203
    ## [3,] 0.01024 1.00000 1.00000
    ## [4,] 0.00427 0.00117 0.00193
    ## [5,] 1.00000 1.00000 0.00218
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##         [,1]   [,2]   [,3]    [,4]   [,5]
    ## [1,] -0.2332  0.000  0.000  0.0000  0.000
    ## [2,] -0.0587 -0.328  0.000  0.0000  0.000
    ## [3,]  0.0000  0.000 -0.587  0.0000  0.000
    ## [4,]  0.0000 -0.128  0.000 -0.1522 -0.104
    ## [5,] -0.0874  0.000  0.000  0.0775 -0.363
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0441 1.0000 1.0000 1.0000 1.0000
    ## [2,] 0.0402 0.0580 1.0000 1.0000 1.0000
    ## [3,] 1.0000 1.0000 0.0486 1.0000 1.0000
    ## [4,] 1.0000 0.0607 1.0000 0.0467 0.0501
    ## [5,] 0.0399 1.0000 1.0000 0.0529 0.0517
    ## AR( 2 )-matrix 
    ##        [,1]     [,2]   [,3]   [,4]  [,5]
    ## [1,] -0.109 -0.00636  0.000 0.0000 0.000
    ## [2,]  0.000 -0.28506  0.000 0.0796 0.127
    ## [3,]  0.000  0.00000 -0.416 0.0000 0.201
    ## [4,]  0.108 -0.25989  0.000 0.0000 0.000
    ## [5,]  0.000 -0.14539  0.000 0.0254 0.000
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0526 0.0725 1.0000 1.0000 1.0000
    ## [2,] 1.0000 0.0579 1.0000 0.0471 0.0512
    ## [3,] 1.0000 1.0000 0.0553 1.0000 0.0830
    ## [4,] 0.0394 0.0538 1.0000 1.0000 1.0000
    ## [5,] 1.0000 0.0505 1.0000 0.0530 1.0000
    ## AR( 3 )-matrix 
    ##        [,1]    [,2]    [,3]  [,4]   [,5]
    ## [1,] 0.0855 -0.0266  0.0000 0.000 0.0000
    ## [2,] 0.0000  0.0000 -0.0394 0.148 0.0335
    ## [3,] 0.0000  0.0000 -0.3073 0.328 0.0000
    ## [4,] 0.0000  0.0000  0.0000 0.117 0.0000
    ## [5,] 0.0000  0.0000  0.0000 0.116 0.0000
    ## standard error 
    ##        [,1]  [,2]  [,3]   [,4]   [,5]
    ## [1,] 0.0513 0.068 1.000 1.0000 1.0000
    ## [2,] 1.0000 1.000 0.019 0.0489 0.0467
    ## [3,] 1.0000 1.000 0.054 0.0917 1.0000
    ## [4,] 1.0000 1.000 1.000 0.0417 1.0000
    ## [5,] 1.0000 1.000 1.000 0.0459 1.0000
    ## AR( 4 )-matrix 
    ##      [,1] [,2]    [,3]   [,4]   [,5]
    ## [1,]    0    0 -0.0513 0.0562 0.0000
    ## [2,]    0    0 -0.0831 0.0607 0.0744
    ## [3,]    0    0 -0.2786 0.3544 0.0000
    ## [4,]    0    0 -0.0759 0.1520 0.1350
    ## [5,]    0    0  0.0000 0.0000 0.0000
    ## standard error 
    ##      [,1] [,2]   [,3]   [,4]   [,5]
    ## [1,]    1    1 0.0218 0.0531 1.0000
    ## [2,]    1    1 0.0221 0.0516 0.0469
    ## [3,]    1    1 0.0545 0.1094 1.0000
    ## [4,]    1    1 0.0169 0.0440 0.0441
    ## [5,]    1    1 1.0000 1.0000 1.0000
    ## AR( 5 )-matrix 
    ##        [,1]  [,2]    [,3]   [,4]   [,5]
    ## [1,] 0.0000 0.000 -0.1270 0.0978 0.0000
    ## [2,] 0.0000 0.000 -0.1440 0.2017 0.0636
    ## [3,] 0.0000 0.297 -0.5077 0.3852 0.0000
    ## [4,] 0.0142 0.000 -0.0905 0.0509 0.1625
    ## [5,] 0.0000 0.000 -0.0402 0.0865 0.0000
    ## standard error 
    ##        [,1]  [,2]   [,3]   [,4]   [,5]
    ## [1,] 1.0000 1.000 0.0255 0.0605 1.0000
    ## [2,] 1.0000 1.000 0.0231 0.0534 0.0486
    ## [3,] 1.0000 0.113 0.0570 0.1226 1.0000
    ## [4,] 0.0352 1.000 0.0193 0.0417 0.0440
    ## [5,] 1.0000 1.000 0.0168 0.0438 1.0000
    ## AR( 6 )-matrix 
    ##         [,1] [,2]    [,3]   [,4]  [,5]
    ## [1,] -0.1027    0 -0.1164 0.0874 0.158
    ## [2,] -0.0639    0 -0.1184 0.1148 0.146
    ## [3,] -0.1133    0 -0.2753 0.3291 0.000
    ## [4,]  0.0000    0 -0.0341 0.0000 0.000
    ## [5,]  0.0586    0 -0.0241 0.0000 0.000
    ## standard error 
    ##        [,1] [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0467    1 0.0261 0.0683 0.0610
    ## [2,] 0.0357    1 0.0229 0.0539 0.0484
    ## [3,] 0.0817    1 0.0603 0.1211 1.0000
    ## [4,] 1.0000    1 0.0162 1.0000 1.0000
    ## [5,] 0.0349    1 0.0175 1.0000 1.0000
    ## AR( 7 )-matrix 
    ##         [,1]  [,2]    [,3]   [,4]   [,5]
    ## [1,] -0.1493 0.000 -0.0736 0.1295  0.000
    ## [2,] -0.0792 0.000 -0.0643 0.1661  0.000
    ## [3,] -0.4456 0.000 -0.2697 0.3832  0.000
    ## [4,] -0.0943 0.000  0.0000 0.0504  0.000
    ## [5,] -0.1419 0.162  0.0000 0.1827 -0.102
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0433 1.0000 0.0225 0.0682 1.0000
    ## [2,] 0.0337 1.0000 0.0216 0.0519 1.0000
    ## [3,] 0.0764 1.0000 0.0626 0.1087 1.0000
    ## [4,] 0.0301 1.0000 1.0000 0.0415 1.0000
    ## [5,] 0.0464 0.0762 1.0000 0.0531 0.0566
    ## AR( 8 )-matrix 
    ##         [,1]    [,2]   [,3]  [,4] [,5]
    ## [1,] -0.0689 -0.2513  0.000 0.307    0
    ## [2,] -0.0524 -0.1326 -0.050 0.271    0
    ## [3,] -0.1827 -0.0633 -0.317 0.191    0
    ## [4,]  0.0000 -0.1538  0.000 0.142    0
    ## [5,]  0.0000 -0.1616  0.000 0.210    0
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4] [,5]
    ## [1,] 0.0552 0.0818 1.0000 0.0699    1
    ## [2,] 0.0416 0.0611 0.0189 0.0523    1
    ## [3,] 0.0966 0.1373 0.0602 0.1069    1
    ## [4,] 1.0000 0.0440 1.0000 0.0417    1
    ## [5,] 1.0000 0.0532 1.0000 0.0553    1
    ## AR( 9 )-matrix 
    ##        [,1]    [,2]   [,3]  [,4]   [,5]
    ## [1,] 0.0000 -0.1960  0.000 0.129  0.000
    ## [2,] 0.0000 -0.1738  0.000 0.148  0.000
    ## [3,] 0.0000  0.0000 -0.223 0.000 -0.233
    ## [4,] 0.0852 -0.0429  0.000 0.000  0.000
    ## [5,] 0.0000  0.0000  0.000 0.165 -0.154
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 1.0000 0.0668 1.0000 0.0717 1.0000
    ## [2,] 1.0000 0.0462 1.0000 0.0502 1.0000
    ## [3,] 1.0000 1.0000 0.0582 1.0000 0.0951
    ## [4,] 0.0397 0.0547 1.0000 1.0000 1.0000
    ## [5,] 1.0000 1.0000 1.0000 0.0537 0.0480
    ## AR( 10 )-matrix 
    ##         [,1]  [,2]    [,3]   [,4]   [,5]
    ## [1,] -0.1642 0.188  0.0000 0.2374  0.000
    ## [2,] -0.0904 0.000  0.0000 0.2520  0.000
    ## [3,]  0.0000 0.000 -0.3359 0.1084  0.000
    ## [4,]  0.0000 0.000  0.0192 0.0000  0.000
    ## [5,]  0.0000 0.166  0.0000 0.0804 -0.126
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0532 0.0804 1.0000 0.0712 1.0000
    ## [2,] 0.0331 1.0000 1.0000 0.0450 1.0000
    ## [3,] 1.0000 1.0000 0.0555 0.0811 1.0000
    ## [4,] 1.0000 1.0000 0.0145 1.0000 1.0000
    ## [5,] 1.0000 0.0623 1.0000 0.0529 0.0582
    ## AR( 11 )-matrix 
    ##       [,1] [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.191 0.00  0.000  0.146 -0.104
    ## [2,] 0.093 0.00  0.000  0.000 -0.103
    ## [3,] 0.000 0.00 -0.192  0.000  0.000
    ## [4,] 0.000 0.12  0.000 -0.128  0.000
    ## [5,] 0.112 0.00  0.000  0.000  0.000
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0471 1.0000 1.0000 0.0641 0.0596
    ## [2,] 0.0362 1.0000 1.0000 1.0000 0.0472
    ## [3,] 1.0000 1.0000 0.0561 1.0000 1.0000
    ## [4,] 1.0000 0.0467 1.0000 0.0425 1.0000
    ## [5,] 0.0333 1.0000 1.0000 1.0000 1.0000
    ## AR( 12 )-matrix 
    ##         [,1]  [,2]  [,3]    [,4]   [,5]
    ## [1,]  0.3841 0.000 0.000 -0.0711 0.0000
    ## [2,] -0.0683 0.180 0.000  0.0000 0.1040
    ## [3,]  0.0000 0.000 0.232  0.0000 0.0419
    ## [4,] -0.1704 0.158 0.000  0.2630 0.0000
    ## [5,]  0.0000 0.294 0.000 -0.0603 0.0868
    ## standard error 
    ##        [,1]   [,2]   [,3]   [,4]   [,5]
    ## [1,] 0.0462 1.0000 1.0000 0.0565 1.0000
    ## [2,] 0.0427 0.0623 1.0000 1.0000 0.0527
    ## [3,] 1.0000 1.0000 0.0496 1.0000 0.0851
    ## [4,] 0.0404 0.0570 1.0000 0.0432 1.0000
    ## [5,] 1.0000 0.0620 1.0000 0.0502 0.0575
    ## ----- 
    ## Residuals cov-mtx: 
    ##              [,1]         [,2]         [,3]         [,4]         [,5]
    ## [1,] 0.0010466665 0.0004786079 0.0003516547 0.0002512821 0.0003776376
    ## [2,] 0.0004786079 0.0005923961 0.0002842278 0.0002599315 0.0003948503
    ## [3,] 0.0003516547 0.0002842278 0.0033029867 0.0001494235 0.0002921070
    ## [4,] 0.0002512821 0.0002599315 0.0001494235 0.0005879429 0.0002859155
    ## [5,] 0.0003776376 0.0003948503 0.0002921070 0.0002859155 0.0007917350
    ##        
    ## det(sse) =  2.871204e-16 
    ## AIC =  -35.06818 
    ## BIC =  -33.62374

    ## Number of parameters:  51 
    ## initial estimates:  0.4863059 -0.04130068 0.04629736 0.06277753 -0.1211444 -0.03113507 0.09873397 -0.02664924 0.06770195 0.496936 -0.0327371 0.1122968 -0.2139033 -0.04522878 -0.1095208 -0.05793 -0.08738393 0.794394 -0.1268533 -0.1283197 -0.04982713 0.4510448 0.1747676 0.01420619 -0.1030485 -0.1185539 -0.06625945 0.06822608 0.4745772 -0.02916452 -0.01084336 -0.100472 -0.08133827 -0.1998551 -0.06203876 0.693428 -0.04136694 -0.1523788 0.8640812 0.001085228 -0.1527943 0.2248544 0.1730084 0.5330936 -0.1949982 -0.05130166 0.9294213 0.03721951 -0.1892987 -0.03363069 0.83082 
    ## 
    ## Coefficient(s):
    ##        Estimate  Std. Error  t value Pr(>|t|)    
    ##  [1,]  0.431202    0.061125    7.054 1.73e-12 ***
    ##  [2,] -0.028022    0.019212   -1.459 0.144700    
    ##  [3,]  0.140660    0.059409    2.368 0.017902 *  
    ##  [4,]  0.139824    0.045370    3.082 0.002057 ** 
    ##  [5,] -0.096781    0.065199   -1.484 0.137706    
    ##  [6,] -0.109130    0.047203   -2.312 0.020782 *  
    ##  [7,]  0.036668    0.058696    0.625 0.532159    
    ##  [8,] -0.054679    0.069147   -0.791 0.429085    
    ##  [9,]  0.045578    0.018708    2.436 0.014841 *  
    ## [10,]  0.439686    0.054398    8.083 6.66e-16 ***
    ## [11,] -0.034213    0.027244   -1.256 0.209187    
    ## [12,]  0.172522    0.050053    3.447 0.000567 ***
    ## [13,] -0.120423    0.071478   -1.685 0.092039 .  
    ## [14,] -0.018195    0.064962   -0.280 0.779417    
    ## [15,] -0.046662    0.042671   -1.094 0.274164    
    ## [16,] -0.055546    0.133952   -0.415 0.678381    
    ## [17,] -0.034152    0.032545   -1.049 0.294008    
    ## [18,]  0.807012    0.050742   15.904  < 2e-16 ***
    ## [19,] -0.145738    0.050658   -2.877 0.004016 ** 
    ## [20,] -0.221377    0.106878   -2.071 0.038331 *  
    ## [21,] -0.060779    0.049405   -1.230 0.218609    
    ## [22,]  0.400742    0.072289    5.544 2.96e-08 ***
    ## [23,]  0.167669    0.062631    2.677 0.007426 ** 
    ## [24,] -0.069908    0.062641   -1.116 0.264420    
    ## [25,] -0.149604    0.052637   -2.842 0.004481 ** 
    ## [26,] -0.020209    0.061513   -0.329 0.742506    
    ## [27,] -0.068035    0.059592   -1.142 0.253583    
    ## [28,]  0.134747    0.052686    2.558 0.010541 *  
    ## [29,]  0.416448    0.037471   11.114  < 2e-16 ***
    ## [30,]  0.102244    0.050127    2.040 0.041382 *  
    ## [31,] -0.004243    0.024227   -0.175 0.860987    
    ## [32,] -0.194014    0.076660   -2.531 0.011379 *  
    ## [33,] -0.067126    0.048541   -1.383 0.166706    
    ## [34,] -0.168177    0.045749   -3.676 0.000237 ***
    ## [35,] -0.048555    0.086177   -0.563 0.573136    
    ## [36,]  0.663458    0.033090   20.050  < 2e-16 ***
    ## [37,] -0.031128    0.018718   -1.663 0.096320 .  
    ## [38,] -0.096828    0.045125   -2.146 0.031890 *  
    ## [39,]  0.844762    0.112904    7.482 7.31e-14 ***
    ## [40,]  0.049685    0.030054    1.653 0.098286 .  
    ## [41,] -0.216125    0.098121   -2.203 0.027621 *  
    ## [42,]  0.121557    0.200976    0.605 0.545289    
    ## [43,]  0.307690    0.248307    1.239 0.215289    
    ## [44,]  0.543757    0.064093    8.484  < 2e-16 ***
    ## [45,] -0.333870    0.149574   -2.232 0.025606 *  
    ## [46,] -0.066787    0.044856   -1.489 0.136507    
    ## [47,]  0.811773    0.029584   27.440  < 2e-16 ***
    ## [48,]  0.099792    0.045017    2.217 0.026640 *  
    ## [49,] -0.362967    0.124452   -2.917 0.003540 ** 
    ## [50,]  0.075412    0.039317    1.918 0.055106 .  
    ## [51,]  0.904085    0.093484    9.671  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## --- 
    ## Estimates in matrix form: 
    ## Regular MA coefficient matrix 
    ## MA( 1 )-matrix 
    ##        [,1]    [,2]    [,3]  [,4]  [,5]
    ## [1,] 0.4312  0.0000 -0.0280 0.141 0.000
    ## [2,] 0.0456  0.4397 -0.0342 0.173 0.000
    ## [3,] 0.0000  0.0000  0.8070 0.000 0.000
    ## [4,] 0.0000 -0.0608  0.0000 0.401 0.168
    ## [5,] 0.0000  0.0000  0.0000 0.135 0.416
    ## MA( 2 )-matrix 
    ##       [,1] [,2]     [,3]    [,4]    [,5]
    ## [1,] 0.140    0  0.00000 -0.0968  0.0000
    ## [2,] 0.000    0  0.00000 -0.1204  0.0000
    ## [3,] 0.000    0 -0.14574  0.0000  0.0000
    ## [4,] 0.000    0  0.00000 -0.0699 -0.1496
    ## [5,] 0.102    0 -0.00424 -0.1940 -0.0671
    ## MA( 3 )-matrix 
    ##         [,1]    [,2] [,3]    [,4]    [,5]
    ## [1,] -0.1091  0.0367    0 -0.0547  0.0000
    ## [2,] -0.0182 -0.0467    0 -0.0555 -0.0342
    ## [3,] -0.2214  0.0000    0  0.0000  0.0000
    ## [4,]  0.0000  0.0000    0 -0.0202 -0.0680
    ## [5,]  0.0000 -0.1682    0 -0.0486  0.0000
    ## Seasonal MA coefficient matrix 
    ## MA( 12 )-matrix 
    ##            [,1]        [,2]        [,3]       [,4]        [,5]
    ## [1,] 0.66345836  0.00000000 -0.03112788 0.00000000 -0.09682814
    ## [2,] 0.00000000  0.84476228  0.00000000 0.04968544 -0.21612475
    ## [3,] 0.12155735  0.30769023  0.54375663 0.00000000 -0.33387021
    ## [4,] 0.00000000 -0.06678706  0.00000000 0.81177261  0.00000000
    ## [5,] 0.09979152 -0.36296734  0.00000000 0.07541212  0.90408516
    ##   
    ## Residuals cov-matrix: 
    ##              resi         resi         resi         resi         resi
    ## resi 0.0008189712 0.0004793722 0.0004289794 0.0002994503 0.0003730061
    ## resi 0.0004793722 0.0006420413 0.0003713161 0.0002855506 0.0004406617
    ## resi 0.0004289794 0.0003713161 0.0037548508 0.0002139241 0.0004317707
    ## resi 0.0002994503 0.0002855506 0.0002139241 0.0006154580 0.0002792936
    ## resi 0.0003730061 0.0004406617 0.0004317707 0.0002792936 0.0007995875
    ## ---- 
    ## aic=  -35.748 
    ## bic=  -35.2381

A reduced model with only ratio of China, TW and KR is reported here. No cointergration among these series so a simple VECM and its impulse response function is reported here.

![](FinalProject_files/figure-markdown_github/report%20china%20tw%20kr%20trade%20ratio-1.png)

    ## Constant term: 
    ## Estimates:  0.0004605079 0 0.0001718598 
    ## Std.Error:  0.0003512617 0 9.543854e-05 
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##         [,1]   [,2]    [,3]
    ## [1,] -0.4395  0.264  0.0000
    ## [2,]  0.0000 -0.402  0.0937
    ## [3,] -0.0255  0.000 -0.3833
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0486 0.1798 0.0000
    ## [2,] 0.0000 0.0553 0.0558
    ## [3,] 0.0126 0.0000 0.0493
    ## AR( 2 )-matrix 
    ##         [,1]   [,2]    [,3]
    ## [1,] -0.1961 -0.288  0.0000
    ## [2,]  0.0000 -0.361  0.0882
    ## [3,] -0.0177 -0.122 -0.1098
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0449 0.1746 0.0000
    ## [2,] 0.0000 0.0559 0.0545
    ## [3,] 0.0125 0.0538 0.0579
    ## AR( 3 )-matrix 
    ##         [,1]    [,2]    [,3]
    ## [1,]  0.0000 -0.3544  0.0000
    ## [2,]  0.0000 -0.1288  0.0000
    ## [3,] -0.0254  0.0987 -0.0712
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0000 0.1640 0.0000
    ## [2,] 0.0000 0.0490 0.0000
    ## [3,] 0.0126 0.0536 0.0552
    ## AR( 4 )-matrix 
    ##         [,1]    [,2] [,3]
    ## [1,] -0.0644 -0.6393  0.5
    ## [2,]  0.0000 -0.0673  0.0
    ## [3,] -0.0181  0.0000  0.0
    ## standard error 
    ##        [,1]   [,2]  [,3]
    ## [1,] 0.0433 0.1927 0.196
    ## [2,] 0.0000 0.0501 0.000
    ## [3,] 0.0119 0.0000 0.000
    ## AR( 5 )-matrix 
    ##      [,1]    [,2]   [,3]
    ## [1,]    0  0.0000 -0.333
    ## [2,]    0 -0.0939  0.000
    ## [3,]    0  0.0000 -0.112
    ## standard error 
    ##      [,1]   [,2]   [,3]
    ## [1,]    0 0.0000 0.1671
    ## [2,]    0 0.0483 0.0000
    ## [3,]    0 0.0000 0.0424
    ## AR( 6 )-matrix 
    ##         [,1]    [,2] [,3]
    ## [1,] -0.2032  0.0000    0
    ## [2,] -0.0151 -0.0711    0
    ## [3,]  0.0000  0.0000    0
    ## standard error 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0447 0.0000    0
    ## [2,] 0.0108 0.0495    0
    ## [3,] 0.0000 0.0000    0
    ## AR( 7 )-matrix 
    ##        [,1]   [,2]    [,3]
    ## [1,] -0.188 -0.224  0.0000
    ## [2,]  0.000 -0.234  0.0000
    ## [3,]  0.000 -0.129 -0.0862
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0433 0.1502 0.0000
    ## [2,] 0.0000 0.0471 0.0000
    ## [3,] 0.0000 0.0484 0.0519
    ## AR( 8 )-matrix 
    ##         [,1]    [,2]  [,3]
    ## [1,] -0.2018  0.0000 0.000
    ## [2,] -0.0128 -0.1856 0.154
    ## [3,] -0.0211 -0.0896 0.000
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0426 0.0000 0.0000
    ## [2,] 0.0106 0.0540 0.0508
    ## [3,] 0.0123 0.0405 0.0000
    ## AR( 9 )-matrix 
    ##         [,1]   [,2]   [,3]
    ## [1,] -0.1027 -0.427  0.392
    ## [2,]  0.0000 -0.147  0.000
    ## [3,] -0.0329  0.000 -0.127
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0412 0.1768 0.1880
    ## [2,] 0.0000 0.0438 0.0000
    ## [3,] 0.0123 0.0000 0.0452
    ## AR( 10 )-matrix 
    ##         [,1]  [,2]    [,3]
    ## [1,] -0.1293 0.000  0.0000
    ## [2,] -0.0255 0.000 -0.0926
    ## [3,] -0.0327 0.151 -0.1907
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0419 0.0000 0.0000
    ## [2,] 0.0103 0.0000 0.0461
    ## [3,] 0.0122 0.0539 0.0578
    ## AR( 11 )-matrix 
    ##         [,1]  [,2]    [,3]
    ## [1,]  0.1770 0.000 -0.6913
    ## [2,]  0.0000 0.160 -0.2118
    ## [3,] -0.0319 0.186 -0.0795
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0403 0.0000 0.1617
    ## [2,] 0.0000 0.0489 0.0521
    ## [3,] 0.0111 0.0562 0.0588
    ## AR( 12 )-matrix 
    ##       [,1]   [,2]   [,3]
    ## [1,] 0.555 -0.354 0.0000
    ## [2,] 0.000  0.330 0.0000
    ## [3,] 0.000  0.303 0.0856
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0452 0.1521 0.0000
    ## [2,] 0.0000 0.0430 0.0000
    ## [3,] 0.0000 0.0531 0.0572
    ## AR( 13 )-matrix 
    ##         [,1]   [,2] [,3]
    ## [1,]  0.3005 -0.244    0
    ## [2,] -0.0164  0.137    0
    ## [3,] -0.0256  0.138    0
    ## standard error 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0500 0.1611    0
    ## [2,] 0.0111 0.0457    0
    ## [3,] 0.0130 0.0437    0
    ##   
    ## Residuals cov-mtx: 
    ##              [,1]         [,2]         [,3]
    ## [1,] 4.033640e-05 2.597836e-06 1.333441e-06
    ## [2,] 2.597836e-06 3.133597e-06 1.377283e-06
    ## [3,] 1.333441e-06 1.377283e-06 2.987317e-06
    ##   
    ## det(SSE) =  2.84886e-16 
    ## AIC =  -35.45298 
    ## BIC =  -34.76729 
    ## HQ  =  -35.1817

![](FinalProject_files/figure-markdown_github/report%20china%20tw%20kr%20trade%20ratio-2.png)

    ## Press return to continue

![](FinalProject_files/figure-markdown_github/report%20china%20tw%20kr%20trade%20ratio-3.png)

CPI, import and oil price is modelled through ECM with cointergration, VEC and seasonal model. VEC is preferred.

![](FinalProject_files/figure-markdown_github/report%20cpi%20import%20oil-1.png)

    ## 
    ## ###################### 
    ## # Johansen-Procedure # 
    ## ###################### 
    ## 
    ## Test type: trace statistic , without linear trend and constant in cointegration 
    ## 
    ## Eigenvalues (lambda):
    ## [1]  6.711343e-02  1.294042e-02  5.411485e-03 -8.496922e-18
    ## 
    ## Values of teststatistic and critical values of test:
    ## 
    ##           test 10pct  5pct  1pct
    ## r <= 2 |  2.07  7.52  9.24 12.97
    ## r <= 1 |  7.05 17.85 19.96 24.60
    ## r = 0  | 33.59 32.00 34.91 41.07
    ## 
    ## Eigenvectors, normalised to first column:
    ## (These are the cointegration relations)
    ## 
    ##                  cpi.l1  imp_all.l1      oil.l1     constant
    ## cpi.l1        1.0000000    1.000000    1.000000    1.0000000
    ## imp_all.l1 -252.2896642 -265.601234 -187.694421 -112.9900870
    ## oil.l1        0.3939041    1.473741   -0.127158   -0.2555079
    ## constant   1251.2756873 1058.580629  739.344000  384.7746173
    ## 
    ## Weights W:
    ## (This is the loading matrix)
    ## 
    ##                 cpi.l1    imp_all.l1        oil.l1      constant
    ## cpi.d     1.790037e-03 -0.0003677940 -1.489902e-03 -6.204830e-16
    ## imp_all.d 6.483195e-05 -0.0000227007  3.792537e-05 -2.050631e-16
    ## oil.d     2.559584e-03 -0.0151137940 -8.326078e-03  5.462321e-14

    ## Equation:  1  npar =  28 
    ## Equation:  2  npar =  27 
    ## Equation:  3  npar =  20 
    ## alpha:  
    ##      [,1]     [,2] [,3]
    ## [1,]    0 5.92e-05    0
    ## standard error 
    ##      [,1]     [,2] [,3]
    ## [1,]    1 3.64e-05    1
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##          [,1]   [,2]    [,3]
    ## [1,]  0.17755  0.000 0.06351
    ## [2,]  0.00328 -0.637 0.00117
    ## [3,] -2.10658  0.000 0.44693
    ## standard error 
    ##         [,1]   [,2]    [,3]
    ## [1,] 0.05650 1.0000 0.00671
    ## [2,] 0.00169 0.0455 0.00021
    ## [3,] 0.49739 1.0000 0.05730
    ## AR( 2 )-matrix 
    ##          [,1]  [,2]  [,3]
    ## [1,] -0.13245  0.00 0.000
    ## [2,]  0.00463 -0.22 0.000
    ## [3,]  0.00000  0.00 0.173
    ## standard error 
    ##         [,1]   [,2]   [,3]
    ## [1,] 0.05542 1.0000 1.0000
    ## [2,] 0.00181 0.0495 1.0000
    ## [3,] 1.00000 1.0000 0.0566
    ## AR( 3 )-matrix 
    ##       [,1]  [,2]     [,3]
    ## [1,] -0.15 0.000 0.018202
    ## [2,]  0.00 0.247 0.000404
    ## [3,] -0.43 0.000 0.000000
    ## standard error 
    ##        [,1]   [,2]     [,3]
    ## [1,] 0.0576 1.0000 0.007239
    ## [2,] 1.0000 0.0493 0.000218
    ## [3,] 0.3180 1.0000 1.000000
    ## AR( 4 )-matrix 
    ##        [,1]  [,2] [,3]
    ## [1,] 0.0854 0.000    0
    ## [2,] 0.0000 0.152    0
    ## [3,] 0.0000 0.000    0
    ## standard error 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0494 1.0000    1
    ## [2,] 1.0000 0.0488    1
    ## [3,] 1.0000 1.0000    1
    ## AR( 5 )-matrix 
    ##          [,1]   [,2] [,3]
    ## [1,] -0.11666 1.8470    0
    ## [2,] -0.00331 0.0903    0
    ## [3,] -0.84458 0.0000    0
    ## standard error 
    ##         [,1]  [,2] [,3]
    ## [1,] 0.04397 0.996    1
    ## [2,] 0.00139 0.036    1
    ## [3,] 0.36320 1.000    1
    ## AR( 6 )-matrix 
    ##      [,1] [,2]    [,3]
    ## [1,]    0 3.85  0.0000
    ## [2,]    0 0.00  0.0000
    ## [3,]    0 8.65 -0.0907
    ## standard error 
    ##      [,1] [,2]   [,3]
    ## [1,]    1 1.08 1.0000
    ## [2,]    1 1.00 1.0000
    ## [3,]    1 8.27 0.0565
    ## AR( 7 )-matrix 
    ##      [,1] [,2]   [,3]
    ## [1,]    0 1.86 0.0091
    ## [2,]    0 0.00 0.0000
    ## [3,]    0 5.11 0.0000
    ## standard error 
    ##      [,1] [,2]    [,3]
    ## [1,]    1 1.05 0.00601
    ## [2,]    1 1.00 1.00000
    ## [3,]    1 8.72 1.00000
    ## AR( 8 )-matrix 
    ##      [,1]    [,2]    [,3]
    ## [1,]    0  3.1475 -0.0143
    ## [2,]    0 -0.0773  0.0000
    ## [3,]    0  0.0000  0.0000
    ## standard error 
    ##      [,1]   [,2]    [,3]
    ## [1,]    1 0.9988 0.00582
    ## [2,]    1 0.0333 1.00000
    ## [3,]    1 1.0000 1.00000
    ## AR( 9 )-matrix 
    ##        [,1]    [,2]     [,3]
    ## [1,]  0.000  0.0000 0.000000
    ## [2,]  0.000 -0.0815 0.000156
    ## [3,] -0.949  0.0000 0.000000
    ## standard error 
    ##       [,1]   [,2]     [,3]
    ## [1,] 1.000 1.0000 1.000000
    ## [2,] 1.000 0.0352 0.000185
    ## [3,] 0.361 1.0000 1.000000
    ## AR( 10 )-matrix 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0646  7.109    0
    ## [2,] 0.0000 -0.133    0
    ## [3,] 0.8118  0.000    0
    ## standard error 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0419 1.0370    1
    ## [2,] 1.0000 0.0337    1
    ## [3,] 0.3557 1.0000    1
    ## AR( 11 )-matrix 
    ##          [,1] [,2]      [,3]
    ## [1,]  0.14717 5.70  0.000000
    ## [2,] -0.00203 0.00 -0.000254
    ## [3,]  0.00000 9.45  0.000000
    ## standard error 
    ##         [,1] [,2]     [,3]
    ## [1,] 0.04962 1.19 1.000000
    ## [2,] 0.00144 1.00 0.000209
    ## [3,] 1.00000 9.21 1.000000
    ## AR( 12 )-matrix 
    ##       [,1]   [,2]    [,3]
    ## [1,] 0.267  5.326 -0.0296
    ## [2,] 0.000  0.613  0.0000
    ## [3,] 1.059 14.124  0.0000
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0555 1.0929 0.0069
    ## [2,] 1.0000 0.0372 1.0000
    ## [3,] 0.3966 9.1840 1.0000
    ## AR( 13 )-matrix 
    ##       [,1]  [,2]     [,3]
    ## [1,] 0.141 0.000 -0.04237
    ## [2,] 0.000 0.367 -0.00087
    ## [3,] 0.909 0.000 -0.21236
    ## standard error 
    ##        [,1]   [,2]    [,3]
    ## [1,] 0.0585 1.0000 0.00717
    ## [2,] 1.0000 0.0507 0.00019
    ## [3,] 0.4951 1.0000 0.06212
    ## AR( 14 )-matrix 
    ##        [,1]   [,2]    [,3]
    ## [1,] 0.0968 0.0000 -0.0113
    ## [2,] 0.0015 0.0811  0.0000
    ## [3,] 1.2238 0.0000 -0.2044
    ## standard error 
    ##         [,1]  [,2]    [,3]
    ## [1,] 0.05983 1.000 0.00728
    ## [2,] 0.00152 0.053 1.00000
    ## [3,] 0.48036 1.000 0.06236
    ## AR( 15 )-matrix 
    ##       [,1]   [,2]      [,3]
    ## [1,] 0.126  0.000 -0.008549
    ## [2,] 0.000 -0.264 -0.000166
    ## [3,] 0.000  0.000 -0.073074
    ## standard error 
    ##        [,1]   [,2]     [,3]
    ## [1,] 0.0578 1.0000 0.007335
    ## [2,] 1.0000 0.0493 0.000227
    ## [3,] 1.0000 1.0000 0.056661
    ## AR( 16 )-matrix 
    ##         [,1]  [,2]      [,3]
    ## [1,] 0.11666  0.00 -0.012109
    ## [2,] 0.00269 -0.27 -0.000534
    ## [3,] 0.36510 13.63  0.000000
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.04730 1.0000 0.006996
    ## [2,] 0.00159 0.0443 0.000221
    ## [3,] 0.33365 8.2987 1.000000
    ## ----- 
    ## Residuals cov-mtx: 
    ##              [,1]         [,2]         [,3]
    ## [1,] 0.1686647542 0.0009717195  0.849349269
    ## [2,] 0.0009717195 0.0001807702  0.008595026
    ## [3,] 0.8493492687 0.0085950255 13.848162412
    ##        
    ## det(sse) =  0.0002804692 
    ## AIC =  -7.803107 
    ## BIC =  -7.053302

    ## Constant term: 
    ## Estimates:  0.3833896 0.01065893 0 
    ## Std.Error:  0.06832014 0.002280895 0 
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##          [,1]   [,2]    [,3]
    ## [1,]  0.11350 -1.907 0.06720
    ## [2,]  0.00303 -0.695 0.00105
    ## [3,] -2.05520  0.000 0.44905
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.06161 1.3969 0.006818
    ## [2,] 0.00196 0.0485 0.000222
    ## [3,] 0.50569 0.0000 0.057652
    ## AR( 2 )-matrix 
    ##          [,1]   [,2]     [,3]
    ## [1,] -0.16514 -2.642 0.013259
    ## [2,]  0.00278 -0.289 0.000328
    ## [3,]  0.00000  0.000 0.169160
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.06199 1.1617 0.007372
    ## [2,] 0.00203 0.0541 0.000246
    ## [3,] 0.00000 0.0000 0.057669
    ## AR( 3 )-matrix 
    ##        [,1]  [,2]    [,3]
    ## [1,] -0.118 0.000 0.01635
    ## [2,]  0.000 0.155 0.00051
    ## [3,] -0.660 0.000 0.00000
    ## standard error 
    ##       [,1]   [,2]     [,3]
    ## [1,] 0.052 0.0000 0.007173
    ## [2,] 0.000 0.0532 0.000226
    ## [3,] 0.388 0.0000 0.000000
    ## AR( 4 )-matrix 
    ##      [,1]   [,2] [,3]
    ## [1,]  0.0 0.0000    0
    ## [2,]  0.0 0.0661    0
    ## [3,]  0.6 0.0000    0
    ## standard error 
    ##       [,1]   [,2] [,3]
    ## [1,] 0.000 0.0000    0
    ## [2,] 0.000 0.0477    0
    ## [3,] 0.442 0.0000    0
    ## AR( 5 )-matrix 
    ##          [,1] [,2]     [,3]
    ## [1,] -0.23182 1.77 0.014708
    ## [2,] -0.00438 0.00 0.000363
    ## [3,] -1.53513 0.00 0.000000
    ## standard error 
    ##         [,1] [,2]     [,3]
    ## [1,] 0.05217 1.14 0.006931
    ## [2,] 0.00167 0.00 0.000231
    ## [3,] 0.36968 0.00 0.000000
    ## AR( 6 )-matrix 
    ##      [,1]    [,2] [,3]
    ## [1,]    0  2.4773    0
    ## [2,]    0 -0.0796    0
    ## [3,]    0  0.0000    0
    ## standard error 
    ##      [,1]   [,2] [,3]
    ## [1,]    0 1.2427    0
    ## [2,]    0 0.0375    0
    ## [3,]    0 0.0000    0
    ## AR( 7 )-matrix 
    ##          [,1]    [,2]   [,3]
    ## [1,] -0.15649  1.8579 0.0193
    ## [2,] -0.00313 -0.0616 0.0000
    ## [3,]  0.00000  0.0000 0.0000
    ## standard error 
    ##         [,1]  [,2]    [,3]
    ## [1,] 0.05203 1.245 0.00692
    ## [2,] 0.00164 0.042 0.00000
    ## [3,] 0.00000 0.000 0.00000
    ## AR( 8 )-matrix 
    ##          [,1]   [,2]     [,3]
    ## [1,]  0.00000  2.599 0.000000
    ## [2,] -0.00398 -0.122 0.000395
    ## [3,]  0.00000  0.000 0.000000
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.00000 1.0734 0.000000
    ## [2,] 0.00198 0.0424 0.000252
    ## [3,] 0.00000 0.0000 0.000000
    ## AR( 9 )-matrix 
    ##          [,1]   [,2]     [,3]
    ## [1,] -0.10503  0.000 0.000000
    ## [2,] -0.00292 -0.132 0.000796
    ## [3,] -0.75212  0.000 0.000000
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.04290 0.0000 0.000000
    ## [2,] 0.00182 0.0416 0.000243
    ## [3,] 0.35638 0.0000 0.000000
    ## AR( 10 )-matrix 
    ##       [,1]   [,2] [,3]
    ## [1,] 0.000  6.544    0
    ## [2,] 0.000 -0.162    0
    ## [3,] 0.689  0.000    0
    ## standard error 
    ##       [,1]   [,2] [,3]
    ## [1,] 0.000 1.1193    0
    ## [2,] 0.000 0.0373    0
    ## [3,] 0.362 0.0000    0
    ## AR( 11 )-matrix 
    ##          [,1]  [,2]   [,3]
    ## [1,]  0.08124  5.63 0.0123
    ## [2,] -0.00563  0.00 0.0000
    ## [3,]  0.00000 16.24 0.0000
    ## standard error 
    ##        [,1] [,2]    [,3]
    ## [1,] 0.0578 1.31 0.00726
    ## [2,] 0.0017 0.00 0.00000
    ## [3,] 0.0000 9.58 0.00000
    ## AR( 12 )-matrix 
    ##          [,1]   [,2]      [,3]
    ## [1,]  0.18360  5.908 -0.022818
    ## [2,] -0.00312  0.616  0.000471
    ## [3,]  0.94154 14.232  0.000000
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.06171 1.3344 0.007425
    ## [2,] 0.00198 0.0386 0.000247
    ## [3,] 0.40796 9.5606 0.000000
    ## AR( 13 )-matrix 
    ##          [,1]  [,2]      [,3]
    ## [1,]  0.06972 1.994 -0.037642
    ## [2,] -0.00266 0.375 -0.000654
    ## [3,]  0.85995 0.000 -0.199447
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.05510 1.3870 0.007330
    ## [2,] 0.00177 0.0525 0.000244
    ## [3,] 0.51055 0.0000 0.064047
    ## AR( 14 )-matrix 
    ##      [,1]     [,2] [,3]
    ## [1,] 0.00   0.0000  0.0
    ## [2,] 0.00   0.0965  0.0
    ## [3,] 1.43 -19.9781 -0.2
    ## standard error 
    ##       [,1]   [,2]   [,3]
    ## [1,] 0.000 0.0000 0.0000
    ## [2,] 0.000 0.0501 0.0000
    ## [3,] 0.499 8.7520 0.0641
    ## AR( 15 )-matrix 
    ##       [,1]   [,2]    [,3]
    ## [1,] 0.065  0.000  0.0000
    ## [2,] 0.000 -0.251  0.0000
    ## [3,] 0.000  0.000 -0.0724
    ## standard error 
    ##       [,1]  [,2]   [,3]
    ## [1,] 0.044 0.000 0.0000
    ## [2,] 0.000 0.049 0.0000
    ## [3,] 0.000 0.000 0.0582
    ## AR( 16 )-matrix 
    ##        [,1]  [,2]      [,3]
    ## [1,] 0.0696  0.00  0.000000
    ## [2,] 0.0000 -0.27 -0.000418
    ## [3,] 0.5446 11.33  0.000000
    ## standard error 
    ##        [,1]   [,2]     [,3]
    ## [1,] 0.0454 0.0000 0.000000
    ## [2,] 0.0000 0.0454 0.000201
    ## [3,] 0.3460 8.3858 0.000000
    ##   
    ## Residuals cov-mtx: 
    ##              [,1]         [,2]         [,3]
    ## [1,] 0.1611681191 0.0007743446  0.807139184
    ## [2,] 0.0007743446 0.0001714301  0.007640006
    ## [3,] 0.8071391843 0.0076400063 13.760985315
    ##   
    ## det(SSE) =  0.0002604124 
    ## AIC =  -7.851234 
    ## BIC =  -7.049937 
    ## HQ  =  -7.533847

    ## Number of parameters:  21 
    ## initial estimates:  -0.5267224 -0.06897593 -0.03158876 0.05108267 0.4457589 -0.001273922 -0.0006030235 -0.00113694 -0.2705067 -0.0007341967 2.675394 -32.16154 -0.3549251 0.9345558 -0.1981424 0.7404301 0.8984362 0.8887793 0.0001122342 9.026298 0.999998 
    ## 
    ## Coefficient(s):
    ##         Estimate  Std. Error  t value Pr(>|t|)    
    ##  [1,] -4.233e-01   4.504e-02   -9.398  < 2e-16 ***
    ##  [2,] -5.516e-02   7.087e-03   -7.784 7.11e-15 ***
    ##  [3,] -4.588e-02   6.313e-03   -7.267 3.67e-13 ***
    ##  [4,] -5.413e-02   4.931e-02   -1.098 0.272265    
    ##  [5,]  5.554e-01   4.028e-02   13.788  < 2e-16 ***
    ##  [6,] -9.445e-04   1.751e-04   -5.393 6.93e-08 ***
    ##  [7,]  2.371e-03   1.922e-03    1.233 0.217406    
    ##  [8,] -6.215e-04   2.394e-04   -2.596 0.009430 ** 
    ##  [9,] -2.330e-01   4.732e-02   -4.923 8.50e-07 ***
    ## [10,] -4.923e-04   1.830e-04   -2.690 0.007149 ** 
    ## [11,]  1.870e+00   5.398e-01    3.463 0.000533 ***
    ## [12,] -3.215e+01   1.073e+01   -2.996 0.002738 ** 
    ## [13,] -4.564e-01   5.879e-02   -7.764 8.22e-15 ***
    ## [14,]  8.664e-01   5.915e-01    1.465 0.142998    
    ## [15,] -9.648e-02   5.877e-02   -1.641 0.100700    
    ## [16,]  8.356e-01   4.346e-01    1.923 0.054502 .  
    ## [17,]  9.399e-01   1.107e-02   84.942  < 2e-16 ***
    ## [18,]  8.119e-01   3.720e-02   21.823  < 2e-16 ***
    ## [19,]  9.955e-05   1.112e-04    0.895 0.370534    
    ## [20,]  8.979e+00   5.836e+00    1.539 0.123923    
    ## [21,]  9.192e-01   1.943e-02   47.308  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## --- 
    ## Estimates in matrix form: 
    ## Regular MA coefficient matrix 
    ## MA( 1 )-matrix 
    ##        [,1]    [,2]      [,3]
    ## [1,] -0.423   0.000 -0.055164
    ## [2,]  0.000   0.555 -0.000945
    ## [3,]  1.870 -32.150 -0.456427
    ## MA( 2 )-matrix 
    ##         [,1] [,2]      [,3]
    ## [1,] 0.00000    0 -0.045879
    ## [2,] 0.00237    0 -0.000621
    ## [3,] 0.86641    0 -0.096476
    ## MA( 3 )-matrix 
    ##         [,1]   [,2]      [,3]
    ## [1,] -0.0541  0.000  0.000000
    ## [2,]  0.0000 -0.233 -0.000492
    ## [3,]  0.8356  0.000  0.000000
    ## Seasonal MA coefficient matrix 
    ## MA( 12 )-matrix 
    ##           [,1]      [,2]         [,3]
    ## [1,] 0.9398921 0.0000000 0.000000e+00
    ## [2,] 0.0000000 0.8118795 9.955002e-05
    ## [3,] 0.0000000 8.9785969 9.191599e-01
    ##   
    ## Residuals cov-matrix: 
    ##              resi         resi         resi
    ## resi 0.2183494284 0.0004521263  1.067984296
    ## resi 0.0004521263 0.0002081805  0.007289443
    ## resi 1.0679842960 0.0072894429 17.209267487
    ## ---- 
    ## aic=  -7.4212 
    ## bic=  -7.206

CPI, import from china and oil price is modeled. Seasonal and VEC has mixed result. ECM with cointergration is preferred

``` r
ca.jo(da_inflation_china, ecdet = "const", type = "trace", K = 14, spec = "transitory") %>%
  summary()
```

    ## 
    ## ###################### 
    ## # Johansen-Procedure # 
    ## ###################### 
    ## 
    ## Test type: trace statistic , without linear trend and constant in cointegration 
    ## 
    ## Eigenvalues (lambda):
    ## [1]  8.979134e-02  3.513803e-02  1.596281e-02 -1.069197e-17
    ## 
    ## Values of teststatistic and critical values of test:
    ## 
    ##           test 10pct  5pct  1pct
    ## r <= 2 |  6.21  7.52  9.24 12.97
    ## r <= 1 | 20.02 17.85 19.96 24.60
    ## r = 0  | 56.33 32.00 34.91 41.07
    ## 
    ## Eigenvectors, normalised to first column:
    ## (These are the cointegration relations)
    ## 
    ##                     cpi.l1 imp_china.l1      oil.l1    constant
    ## cpi.l1           1.0000000    1.0000000    1.000000   1.0000000
    ## imp_china.l1   325.1976266  -35.2322668 -146.609111 -56.2798838
    ## oil.l1          -0.5018197    0.3585839    1.666956  -0.3350893
    ## constant     -2460.1674986  -18.2026446  317.818893  47.7832835
    ## 
    ## Weights W:
    ## (This is the loading matrix)
    ## 
    ##                    cpi.l1  imp_china.l1        oil.l1      constant
    ## cpi.d       -3.046104e-04  2.197692e-03 -4.674865e-04  1.638311e-16
    ## imp_china.d -3.194795e-05 -8.553667e-05  1.205529e-05 -6.100229e-18
    ## oil.d       -1.009404e-03  5.179281e-03 -1.323819e-02 -8.067136e-15

``` r
m16 <- refECMvar1(m15, thres = 1.2) # this is better 
```

    ## Equation:  1  npar =  24 
    ## Equation:  2  npar =  23 
    ## Equation:  3  npar =  16 
    ## alpha:  
    ##           [,1]    [,2]
    ## [1,]  0.00e+00  0.0000
    ## [2,] -3.72e-05  0.0000
    ## [3,]  5.09e-03 -0.0319
    ## standard error 
    ##          [,1]   [,2]
    ## [1,] 1.00e+00 1.0000
    ## [2,] 8.34e-06 1.0000
    ## [3,] 2.35e-03 0.0137
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##       [,1]   [,2]   [,3]
    ## [1,]  0.21  0.000 0.0638
    ## [2,]  0.00 -0.415 0.0000
    ## [3,] -1.11  0.000 0.4124
    ## standard error 
    ##        [,1]   [,2]    [,3]
    ## [1,] 0.0556 1.0000 0.00684
    ## [2,] 1.0000 0.0444 1.00000
    ## [3,] 0.4546 1.0000 0.05755
    ## AR( 2 )-matrix 
    ##          [,1]   [,2]  [,3]
    ## [1,] -0.08595  0.000 0.000
    ## [2,]  0.00935 -0.321 0.000
    ## [3,]  0.00000  0.000 0.109
    ## standard error 
    ##         [,1]   [,2]   [,3]
    ## [1,] 0.05309 1.0000 1.0000
    ## [2,] 0.00239 0.0407 1.0000
    ## [3,] 1.00000 1.0000 0.0553
    ## AR( 3 )-matrix 
    ##        [,1] [,2]   [,3]
    ## [1,] -0.156 1.29 0.0125
    ## [2,]  0.000 0.00 0.0000
    ## [3,]  0.000 0.00 0.0000
    ## standard error 
    ##       [,1]  [,2]    [,3]
    ## [1,] 0.056 0.571 0.00717
    ## [2,] 1.000 1.000 1.00000
    ## [3,] 1.000 1.000 1.00000
    ## AR( 4 )-matrix 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.1556  0.000    0
    ## [2,] 0.0103 -0.173    0
    ## [3,] 0.2244  0.000    0
    ## standard error 
    ##         [,1]   [,2] [,3]
    ## [1,] 0.05086 1.0000    1
    ## [2,] 0.00272 0.0413    1
    ## [3,] 0.34285 1.0000    1
    ## AR( 5 )-matrix 
    ##        [,1]   [,2]      [,3]
    ## [1,] -0.137  2.453  0.000000
    ## [2,]  0.000 -0.167 -0.000865
    ## [3,] -0.898  0.000  0.000000
    ## standard error 
    ##       [,1]   [,2]     [,3]
    ## [1,] 0.050 0.5764 1.000000
    ## [2,] 1.000 0.0412 0.000411
    ## [3,] 0.391 1.0000 1.000000
    ## AR( 6 )-matrix 
    ##       [,1]  [,2]    [,3]
    ## [1,] 0.101  0.00  0.0000
    ## [2,] 0.000 -0.25  0.0000
    ## [3,] 0.000  0.00 -0.0662
    ## standard error 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0425 1.0000 1.0000
    ## [2,] 1.0000 0.0424 1.0000
    ## [3,] 1.0000 1.0000 0.0546
    ## AR( 7 )-matrix 
    ##          [,1]   [,2] [,3]
    ## [1,]  0.00000  0.750    0
    ## [2,]  0.00479 -0.236    0
    ## [3,] -0.17604  0.000    0
    ## standard error 
    ##         [,1]   [,2] [,3]
    ## [1,] 1.00000 0.5491    1
    ## [2,] 0.00266 0.0406    1
    ## [3,] 0.29787 1.0000    1
    ## AR( 8 )-matrix 
    ##      [,1]   [,2]      [,3]
    ## [1,]    0  1.930 -0.008185
    ## [2,]    0 -0.218 -0.000403
    ## [3,]    0  0.000  0.000000
    ## standard error 
    ##      [,1]   [,2]     [,3]
    ## [1,]    1 0.5459 0.005619
    ## [2,]    1 0.0393 0.000427
    ## [3,]    1 1.0000 1.000000
    ## AR( 9 )-matrix 
    ##         [,1]   [,2]     [,3]
    ## [1,] -0.0538  1.155 0.000000
    ## [2,]  0.0000 -0.123 0.000978
    ## [3,] -0.7007  0.000 0.000000
    ## standard error 
    ##        [,1]   [,2]     [,3]
    ## [1,] 0.0421 0.5386 1.000000
    ## [2,] 1.0000 0.0386 0.000379
    ## [3,] 0.3500 1.0000 1.000000
    ## AR( 10 )-matrix 
    ##         [,1]   [,2] [,3]
    ## [1,] 0.11544  2.376    0
    ## [2,] 0.00459 -0.225    0
    ## [3,] 0.75210  3.542    0
    ## standard error 
    ##         [,1]   [,2] [,3]
    ## [1,] 0.04884 0.5633    1
    ## [2,] 0.00279 0.0388    1
    ## [3,] 0.35101 4.2589    1
    ## AR( 11 )-matrix 
    ##          [,1]   [,2] [,3]
    ## [1,]  0.17370 0.6282    0
    ## [2,] -0.00933 0.0745    0
    ## [3,]  0.00000 0.0000    0
    ## standard error 
    ##         [,1]   [,2] [,3]
    ## [1,] 0.05095 0.5358    1
    ## [2,] 0.00323 0.0409    1
    ## [3,] 1.00000 1.0000    1
    ## AR( 12 )-matrix 
    ##       [,1] [,2]    [,3]
    ## [1,] 0.297 2.27 -0.0242
    ## [2,] 0.011 0.40  0.0000
    ## [3,] 1.026 6.31  0.0000
    ## standard error 
    ##         [,1]   [,2]    [,3]
    ## [1,] 0.05531 0.5398 0.00699
    ## [2,] 0.00317 0.0427 1.00000
    ## [3,] 0.38317 4.1360 1.00000
    ## AR( 13 )-matrix 
    ##       [,1]  [,2]      [,3]
    ## [1,] 0.147 0.000 -0.043209
    ## [2,] 0.000 0.241 -0.000985
    ## [3,] 0.739 0.000 -0.252299
    ## standard error 
    ##        [,1]   [,2]     [,3]
    ## [1,] 0.0495 1.0000 0.007083
    ## [2,] 1.0000 0.0425 0.000412
    ## [3,] 0.4009 1.0000 0.060017
    ## ----- 
    ## Residuals cov-mtx: 
    ##             [,1]          [,2]         [,3]
    ## [1,] 0.184382022  0.0015797661  0.893159005
    ## [2,] 0.001579766  0.0008109092 -0.001459036
    ## [3,] 0.893159005 -0.0014590356 14.143251860
    ##        
    ## det(sse) =  0.001427962 
    ## AIC =  -6.236507 
    ## BIC =  -5.607851

``` r
m20 <- refsVARMA(m19, thres = 1.2) # for prediction
```

    ## Number of parameters:  17 
    ## initial estimates:  -0.5278736 -0.06864612 -0.03416046 0.05138616 -0.0202414 0.4799969 -0.0008578848 0.0006125031 -0.000804871 2.670826 -0.3546566 0.9068875 -0.1985918 8.631806 0.8973339 0.6777093 0.9999894 
    ## 
    ## Coefficient(s):
    ##         Estimate  Std. Error  t value Pr(>|t|)    
    ##  [1,] -0.4245612   0.0494435   -8.587  < 2e-16 ***
    ##  [2,] -0.0548373   0.0064641   -8.483  < 2e-16 ***
    ##  [3,] -0.0339629   0.0072558   -4.681 2.86e-06 ***
    ##  [4,]  0.0777659   0.0471016    1.651 0.098733 .  
    ##  [5,] -0.0139971   0.0060793   -2.302 0.021312 *  
    ##  [6,]  0.4828502   0.0550815    8.766  < 2e-16 ***
    ##  [7,]  0.0064775   0.0039384    1.645 0.100030    
    ##  [8,]  0.1144703   0.0645357    1.774 0.076104 .  
    ##  [9,] -0.0011656   0.0003492   -3.338 0.000843 ***
    ## [10,]  1.4605957   0.4785671    3.052 0.002273 ** 
    ## [11,] -0.4561914   0.0588919   -7.746 9.55e-15 ***
    ## [12,]  0.5141020   0.4916656    1.046 0.295730    
    ## [13,] -0.2000322   0.0621300   -3.220 0.001284 ** 
    ## [14,] -0.7475632   4.8646390   -0.154 0.877868    
    ## [15,]  0.8852907   0.0206747   42.820  < 2e-16 ***
    ## [16,]  0.6213705   0.0366972   16.932  < 2e-16 ***
    ## [17,]  0.9086715   0.0197374   46.038  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## --- 
    ## Estimates in matrix form: 
    ## Regular MA coefficient matrix 
    ## MA( 1 )-matrix 
    ##        [,1]  [,2]    [,3]
    ## [1,] -0.425 0.000 -0.0548
    ## [2,]  0.000 0.483  0.0000
    ## [3,]  1.461 0.000 -0.4562
    ## MA( 2 )-matrix 
    ##         [,1]  [,2]     [,3]
    ## [1,] 0.00000 0.000 -0.03396
    ## [2,] 0.00648 0.114 -0.00117
    ## [3,] 0.51410 0.000 -0.20003
    ## MA( 3 )-matrix 
    ##        [,1]   [,2]   [,3]
    ## [1,] 0.0778  0.000 -0.014
    ## [2,] 0.0000  0.000  0.000
    ## [3,] 0.0000 -0.748  0.000
    ## Seasonal MA coefficient matrix 
    ## MA( 12 )-matrix 
    ##           [,1]      [,2]      [,3]
    ## [1,] 0.8852907 0.0000000 0.0000000
    ## [2,] 0.0000000 0.6213705 0.0000000
    ## [3,] 0.0000000 0.0000000 0.9086715
    ##   
    ## Residuals cov-matrix: 
    ##               resi          resi         resi
    ## resi  0.2017451267 -0.0003273674  1.071492866
    ## resi -0.0003273674  0.0007955704 -0.007532561
    ## resi  1.0714928660 -0.0075325614 17.102384218
    ## ---- 
    ## aic=  -6.2191 
    ## bic=  -6.0452

CPI, china trade as ratio, oil. Seasonal Behavior is salient

``` r
MTSplot(da_inflation_rchina)
```

![](FinalProject_files/figure-markdown_github/trade%20inflation%20cn%20ratio-1.png)

``` r
m26 <- refECMvar1(m25, thres = 1.2)
```

    ## Equation:  1  npar =  28 
    ## Equation:  2  npar =  34 
    ## Equation:  3  npar =  16 
    ## alpha:  
    ##      [,1] [,2] [,3]
    ## [1,]    0    0    0
    ## standard error 
    ##      [,1] [,2] [,3]
    ## [1,]    1    1    1
    ## AR coefficient matrix 
    ## AR( 1 )-matrix 
    ##          [,1]   [,2]      [,3]
    ## [1,]  0.07681 -3.343  0.072288
    ## [2,] -0.00172 -0.606 -0.000274
    ## [3,] -2.01511  0.000  0.444672
    ## standard error 
    ##          [,1]   [,2]     [,3]
    ## [1,] 0.048682 2.7691 6.60e-03
    ## [2,] 0.000759 0.0485 9.18e-05
    ## [3,] 0.477124 1.0000 5.61e-02
    ## AR( 2 )-matrix 
    ##          [,1]   [,2]  [,3]
    ## [1,]  0.00000 -4.689 0.000
    ## [2,] -0.00209 -0.521 0.000
    ## [3,]  0.00000  0.000 0.163
    ## standard error 
    ##          [,1]   [,2]   [,3]
    ## [1,] 1.000000 3.3054 1.0000
    ## [2,] 0.000638 0.0544 1.0000
    ## [3,] 1.000000 1.0000 0.0551
    ## AR( 3 )-matrix 
    ##        [,1]  [,2]    [,3]
    ## [1,] -0.129 -4.34 0.00631
    ## [2,]  0.000 -0.26 0.00000
    ## [3,] -0.614  0.00 0.00000
    ## standard error 
    ##       [,1]   [,2]    [,3]
    ## [1,] 0.047 2.9586 0.00662
    ## [2,] 1.000 0.0584 1.00000
    ## [3,] 0.364 1.0000 1.00000
    ## AR( 4 )-matrix 
    ##       [,1]   [,2] [,3]
    ## [1,] 0.000  0.000    0
    ## [2,] 0.000 -0.236    0
    ## [3,] 0.592  0.000    0
    ## standard error 
    ##      [,1]   [,2] [,3]
    ## [1,] 1.00 1.0000    1
    ## [2,] 1.00 0.0573    1
    ## [3,] 0.42 1.0000    1
    ## AR( 5 )-matrix 
    ##         [,1]   [,2]      [,3]
    ## [1,] -0.0956  7.822  0.014046
    ## [2,]  0.0000 -0.118 -0.000222
    ## [3,] -1.4059 45.326  0.000000
    ## standard error 
    ##        [,1]    [,2]     [,3]
    ## [1,] 0.0558  2.4810 6.98e-03
    ## [2,] 1.0000  0.0535 7.56e-05
    ## [3,] 0.3616 21.5564 1.00e+00
    ## AR( 6 )-matrix 
    ##       [,1]   [,2] [,3]
    ## [1,] 0.175 -7.161    0
    ## [2,] 0.000 -0.152    0
    ## [3,] 0.000  0.000    0
    ## standard error 
    ##        [,1]   [,2] [,3]
    ## [1,] 0.0453 2.5788    1
    ## [2,] 1.0000 0.0531    1
    ## [3,] 1.0000 1.0000    1
    ## AR( 7 )-matrix 
    ##      [,1]   [,2] [,3]
    ## [1,]    0  0.000    0
    ## [2,]    0 -0.195    0
    ## [3,]    0  0.000    0
    ## standard error 
    ##      [,1]   [,2] [,3]
    ## [1,]    1 1.0000    1
    ## [2,]    1 0.0533    1
    ## [3,]    1 1.0000    1
    ## AR( 8 )-matrix 
    ##         [,1]   [,2]      [,3]
    ## [1,] 0.00000  6.971 -0.004959
    ## [2,] 0.00225 -0.248 -0.000321
    ## [3,] 0.00000  0.000  0.000000
    ## standard error 
    ##          [,1]  [,2]     [,3]
    ## [1,] 1.000000 2.888 5.83e-03
    ## [2,] 0.000783 0.056 9.62e-05
    ## [3,] 1.000000 1.000 1.00e+00
    ## AR( 9 )-matrix 
    ##         [,1]   [,2]    [,3]
    ## [1,]  0.0000 17.573 0.00579
    ## [2,] -0.0028 -0.134 0.00021
    ## [3,] -0.2467 47.882 0.00000
    ## standard error 
    ##          [,1]    [,2]     [,3]
    ## [1,] 1.000000  3.0208 0.005768
    ## [2,] 0.000837  0.0564 0.000105
    ## [3,] 0.289786 23.2180 1.000000
    ## AR( 10 )-matrix 
    ##         [,1]  [,2]     [,3]
    ## [1,] 0.14451  7.77 0.000000
    ## [2,] 0.00166 -0.11 0.000163
    ## [3,] 0.00000 80.23 0.000000
    ## standard error 
    ##          [,1]    [,2]     [,3]
    ## [1,] 0.044206  2.9258 1.000000
    ## [2,] 0.000842  0.0534 0.000106
    ## [3,] 1.000000 23.4584 1.000000
    ## AR( 11 )-matrix 
    ##          [,1] [,2]   [,3]
    ## [1,]  0.15090 0.00 0.0112
    ## [2,] -0.00186 0.15 0.0000
    ## [3,]  0.00000 0.00 0.0000
    ## standard error 
    ##          [,1]   [,2]    [,3]
    ## [1,] 0.055933 1.0000 0.00744
    ## [2,] 0.000772 0.0536 1.00000
    ## [3,] 1.000000 1.0000 1.00000
    ## AR( 12 )-matrix 
    ##         [,1]  [,2]      [,3]
    ## [1,] 0.28905 5.352 -0.021654
    ## [2,] 0.00168 0.543  0.000229
    ## [3,] 1.55648 0.000  0.000000
    ## standard error 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.06009 2.7555 7.11e-03
    ## [2,] 0.00075 0.0565 9.75e-05
    ## [3,] 0.37804 1.0000 1.00e+00
    ## AR( 13 )-matrix 
    ##        [,1] [,2]      [,3]
    ## [1,] 0.0404  0.0 -0.035963
    ## [2,] 0.0000  0.4  0.000231
    ## [3,] 0.0000  0.0 -0.168023
    ## standard error 
    ##      [,1]  [,2]     [,3]
    ## [1,] 0.06 1.000 7.18e-03
    ## [2,] 1.00 0.061 9.14e-05
    ## [3,] 1.00 1.000 5.61e-02
    ## AR( 14 )-matrix 
    ##       [,1]  [,2]   [,3]
    ## [1,] 0.133 6.722  0.000
    ## [2,] 0.000 0.291  0.000
    ## [3,] 1.338 0.000 -0.187
    ## standard error 
    ##        [,1]  [,2]   [,3]
    ## [1,] 0.0447 2.945 1.0000
    ## [2,] 1.0000 0.061 1.0000
    ## [3,] 0.3900 1.000 0.0614
    ## AR( 15 )-matrix 
    ##         [,1]   [,2]     [,3]
    ## [1,] 0.00000  0.000 0.000000
    ## [2,] 0.00157  0.177 0.000232
    ## [3,] 0.00000 55.688 0.000000
    ## standard error 
    ##          [,1]    [,2]     [,3]
    ## [1,] 1.000000  1.0000 1.00e+00
    ## [2,] 0.000783  0.0579 9.71e-05
    ## [3,] 1.000000 22.5209 1.00e+00
    ## AR( 16 )-matrix 
    ##         [,1]  [,2]      [,3]
    ## [1,] 0.09105 0.000  0.000000
    ## [2,] 0.00354 0.119 -0.000321
    ## [3,] 0.48496 0.000  0.000000
    ## standard error 
    ##          [,1]   [,2]     [,3]
    ## [1,] 0.039732 1.0000 1.000000
    ## [2,] 0.000685 0.0493 0.000101
    ## [3,] 0.316726 1.0000 1.000000
    ## ----- 
    ## Residuals cov-mtx: 
    ##               [,1]          [,2]         [,3]
    ## [1,]  0.1705956318 -1.396549e-04  0.816379970
    ## [2,] -0.0001396549  3.155929e-05 -0.003140423
    ## [3,]  0.8163799698 -3.140423e-03 13.887485861
    ##        
    ## det(sse) =  5.249778e-05 
    ## AIC =  -9.463762 
    ## BIC =  -8.683965

``` r
m28 <- refsVARMA(m27, thres = 1.2) # this is prefered
```

    ## Number of parameters:  16 
    ## initial estimates:  -0.5315182 -0.06950173 6.103891 -0.02589801 0.001622291 0.4679702 0.0004018551 0.002716832 2.659035 -0.3544572 58.57026 -0.1973505 0.8999134 0.738935 -44.5083 0.9999996 
    ## 
    ## Coefficient(s):
    ##         Estimate  Std. Error  t value Pr(>|t|)    
    ##  [1,] -4.257e-01   4.157e-02  -10.242  < 2e-16 ***
    ##  [2,] -5.529e-02   6.035e-03   -9.162  < 2e-16 ***
    ##  [3,]  5.546e+00   3.098e+00    1.790 0.073467 .  
    ##  [4,] -2.664e-02   5.544e-03   -4.805 1.55e-06 ***
    ##  [5,]  1.138e-03   8.420e-04    1.351 0.176694    
    ##  [6,]  5.754e-01   4.726e-02   12.176  < 2e-16 ***
    ##  [7,]  3.605e-04   7.391e-05    4.878 1.07e-06 ***
    ##  [8,]  1.127e-03   6.745e-04    1.670 0.094895 .  
    ##  [9,]  1.460e+00   4.377e-01    3.337 0.000848 ***
    ## [10,] -4.550e-01   5.519e-02   -8.244 2.22e-16 ***
    ## [11,]  2.945e+01   2.777e+01    1.061 0.288898    
    ## [12,] -1.226e-01   4.543e-02   -2.699 0.006963 ** 
    ## [13,]  8.900e-01   2.133e-02   41.722  < 2e-16 ***
    ## [14,]  7.086e-01   3.070e-02   23.081  < 2e-16 ***
    ## [15,] -1.840e+00   1.279e+01   -0.144 0.885608    
    ## [16,]  9.137e-01   1.892e-02   48.289  < 2e-16 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## --- 
    ## Estimates in matrix form: 
    ## Regular MA coefficient matrix 
    ## MA( 1 )-matrix 
    ##          [,1]  [,2]      [,3]
    ## [1,] -0.42575 0.000 -0.055289
    ## [2,]  0.00114 0.575  0.000361
    ## [3,]  1.46034 0.000 -0.454965
    ## MA( 2 )-matrix 
    ##         [,1]  [,2]    [,3]
    ## [1,] 0.00000  5.55 -0.0266
    ## [2,] 0.00113  0.00  0.0000
    ## [3,] 0.00000 29.45 -0.1226
    ## Seasonal MA coefficient matrix 
    ## MA( 12 )-matrix 
    ##           [,1]       [,2]      [,3]
    ## [1,] 0.8900164  0.0000000 0.0000000
    ## [2,] 0.0000000  0.7086239 0.0000000
    ## [3,] 0.0000000 -1.8402589 0.9137099
    ##   
    ## Residuals cov-matrix: 
    ##               resi          resi         resi
    ## resi  0.2044231384 -2.812993e-04  1.079816072
    ## resi -0.0002812993  3.330171e-05 -0.003783301
    ## resi  1.0798160722 -3.783301e-03 17.035262688
    ## ---- 
    ## aic=  -9.4129 
    ## bic=  -9.249

Use trade and oil as exogenous shock to model the cpi and ppi.

``` r
MTSplot(da_ppi_cpi)
```

![](FinalProject_files/figure-markdown_github/report%20exogenous%20shock-1.png)

``` r
MTSplot(da_trade_oil)
```

![](FinalProject_files/figure-markdown_github/report%20exogenous%20shock-2.png)

``` r
m24 <- refVARX(m23, thres = 1.2)
```

    ## constant term:  
    ## est:  0 0 
    ##  se:  1 1 
    ## AR( 1 ) matrix 
    ##       [,1]  [,2]
    ## [1,] 1.333 0.000
    ## [2,] 0.000 1.092
    ## standard errors 
    ##       [,1]  [,2]
    ## [1,] 0.045 1.000
    ## [2,] 1.000 0.047
    ## AR( 2 ) matrix 
    ##        [,1]   [,2]
    ## [1,] -0.332  0.000
    ## [2,]  0.000 -0.104
    ## standard errors 
    ##       [,1]  [,2]
    ## [1,] 0.045 1.000
    ## [2,] 1.000 0.047
    ## Coefficients of exogenous 
    ## lag- 0  coefficient matrix 
    ##      [,1] [,2]  [,3]
    ## [1,]    0 0.69 0.072
    ## [2,]    0 0.00 0.232
    ## standard errors 
    ##      [,1]  [,2]  [,3]
    ## [1,]    1 0.428 0.005
    ## [2,]    1 1.000 0.013
    ## lag- 1  coefficient matrix 
    ##        [,1]   [,2]   [,3]
    ## [1,] -4.923 -0.907 -0.036
    ## [2,]  0.000 -2.125 -0.168
    ## standard errors 
    ##       [,1]  [,2]  [,3]
    ## [1,] 0.713 0.429 0.009
    ## [2,] 1.000 0.746 0.019
    ## lag- 2  coefficient matrix 
    ##      [,1] [,2]   [,3]
    ## [1,]    0    0 -0.044
    ## [2,]    0    0  0.000
    ## standard errors 
    ##      [,1] [,2]  [,3]
    ## [1,]    1    1 0.009
    ## [2,]    1    1 1.000
    ## lag- 3  coefficient matrix 
    ##       [,1]  [,2]   [,3]
    ## [1,] 5.093 0.000  0.010
    ## [2,] 0.000 2.522 -0.056
    ## standard errors 
    ##       [,1]  [,2]  [,3]
    ## [1,] 0.711 1.000 0.006
    ## [2,] 1.000 0.754 0.011
    ## Residual Covariance Matrix 
    ##         cpi     ppi
    ## cpi 0.16058 0.22807
    ## ppi 0.22807 0.98098
    ## =========== 
    ## Information criteria:  
    ## AIC:  -2.163051 
    ## BIC:  -1.992132

Prediction.

``` r
sVARMApred(m8, orig = 0, h = 12) # trade among 5 east asian country
```

    ## Predictions at origin  412 
    ##  imp_china imp_tw imp_hk imp_jp imp_kr
    ##      4.610  3.671  2.459  4.062  3.853
    ##      4.614  3.662  2.516  4.050  3.814
    ##      4.625  3.647  2.427  4.088  3.845
    ##      4.634  3.640  2.512  4.111  3.847
    ##      4.644  3.631  2.692  4.056  3.812
    ##      4.665  3.678  2.560  4.136  3.855
    ##      4.621  3.618  2.455  4.094  3.806
    ##      4.607  3.584  2.500  4.112  3.818
    ##      4.597  3.599  2.571  4.095  3.870
    ##      4.526  3.506  2.448  4.092  3.830
    ##      4.533  3.544  2.837  4.161  3.911
    ##      4.589  3.571  2.758  4.145  3.941
    ## Standard errors of predictions 
    ##          resi    resi    resi    resi    resi
    ##  [1,] 0.02862 0.02534 0.06128 0.02481 0.02828
    ##  [2,] 0.03261 0.02834 0.06241 0.02858 0.03224
    ##  [3,] 0.03488 0.03139 0.06577 0.03333 0.03686
    ##  [4,] 0.03813 0.03530 0.06972 0.03812 0.04251
    ##  [5,] 0.04113 0.03882 0.07346 0.04238 0.04750
    ##  [6,] 0.04393 0.04205 0.07702 0.04625 0.05200
    ##  [7,] 0.04655 0.04505 0.08042 0.04982 0.05615
    ##  [8,] 0.04904 0.04786 0.08368 0.05314 0.06001
    ##  [9,] 0.05140 0.05051 0.08682 0.05628 0.06364
    ## [10,] 0.05367 0.05303 0.08985 0.05924 0.06707
    ## [11,] 0.05584 0.05544 0.09278 0.06207 0.07033
    ## [12,] 0.05793 0.05774 0.09562 0.06477 0.07345

``` r
sVARMApred(m6, orig = 0, h =12 ) # trade ratio among China, TW and KR
```

    ## Predictions at origin  412 
    ##  imp_china imp_tw imp_hk
    ##      4.614  3.687  2.462
    ##      4.623  3.681  2.519
    ##      4.636  3.657  2.436
    ##      4.633  3.633  2.517
    ##      4.645  3.622  2.687
    ##      4.659  3.659  2.546
    ##      4.619  3.605  2.435
    ##      4.597  3.565  2.471
    ##      4.562  3.549  2.523
    ##      4.483  3.440  2.387
    ##      4.477  3.468  2.759
    ##      4.523  3.495  2.688
    ## Standard errors of predictions 
    ##          resi    resi    resi
    ##  [1,] 0.02902 0.02625 0.06279
    ##  [2,] 0.03306 0.02918 0.06383
    ##  [3,] 0.03666 0.03241 0.06805
    ##  [4,] 0.03993 0.03570 0.07202
    ##  [5,] 0.04296 0.03871 0.07579
    ##  [6,] 0.04579 0.04151 0.07937
    ##  [7,] 0.04845 0.04412 0.08280
    ##  [8,] 0.05097 0.04659 0.08610
    ##  [9,] 0.05338 0.04894 0.08927
    ## [10,] 0.05568 0.05118 0.09234
    ## [11,] 0.05788 0.05332 0.09530
    ## [12,] 0.06001 0.05538 0.09818

``` r
VARpred(m12, h = 12) # CPI imp_all and oil error correction form
```

    ## orig  398 
    ## Forecasts at origin:  398 
    ##      cpi   imp_all     oil
    ##   1.1066 -0.002631  3.4181
    ##   0.6123  0.014449  2.5862
    ##   0.4313  0.010841  0.8805
    ##  -0.1134  0.002791  0.2247
    ##   0.3992 -0.003135  0.1920
    ##   0.3793 -0.001958 -0.6284
    ##  -0.2663  0.036656 -1.8697
    ##  -0.3322 -0.044694 -2.5071
    ##   0.1160  0.008849 -0.3214
    ##   0.7758 -0.014241  1.9155
    ##   0.6711 -0.031809  2.6323
    ##   1.0387  0.058717  2.5608
    ## Standard Errors of predictions:  
    ##         [,1]    [,2]  [,3]
    ##  [1,] 0.4015 0.01309 3.710
    ##  [2,] 0.4858 0.01617 3.966
    ##  [3,] 0.5097 0.01639 4.033
    ##  [4,] 0.5212 0.01686 4.046
    ##  [5,] 0.5225 0.01715 4.050
    ##  [6,] 0.5254 0.01726 4.068
    ##  [7,] 0.5292 0.01729 4.093
    ##  [8,] 0.5299 0.01736 4.102
    ##  [9,] 0.5308 0.01743 4.119
    ## [10,] 0.5320 0.01743 4.128
    ## [11,] 0.5386 0.01761 4.139
    ## [12,] 0.5504 0.01776 4.148
    ## Root mean square errors of predictions:  
    ##           [,1]    [,2]    [,3]
    ##  [1,]   0.4255 0.01388   3.931
    ##  [2,] 142.8426 4.95330 731.980
    ##  [3,]  80.4845 1.40751 382.167
    ##  [4,]  56.7274 2.05106 171.800
    ##  [5,]  19.7396 1.66229  87.237
    ##  [6,]  28.6056 0.97103 203.039
    ##  [7,]  33.0538 0.53676 235.440
    ##  [8,]  14.3473 0.85115 144.085
    ##  [9,]  15.8770 0.77668 192.692
    ## [10,]  19.0728 0.19749 142.179
    ## [11,]  43.6745 1.30865 155.527
    ## [12,]  59.3537 1.19547 144.535

``` r
sVARMApred(m14, orig = 0, h =12 ) # data the same as m12
```

    ## Predictions at origin  399 
    ##    cpi imp_all   oil
    ##  254.7   5.338 59.19
    ##  256.0   5.357 59.57
    ##  257.0   5.351 62.43
    ##  256.7   5.353 59.85
    ##  257.2   5.364 62.22
    ##  257.4   5.344 61.25
    ##  257.4   5.387 62.23
    ##  257.7   5.352 60.45
    ##  255.4   5.331 49.22
    ##  255.3   5.315 45.05
    ##  256.5   5.265 49.56
    ##  258.0   5.324 51.41
    ## Standard errors of predictions 
    ##         resi    resi   resi
    ##  [1,] 0.4673 0.01443  4.148
    ##  [2,] 0.9385 0.01646  7.036
    ##  [3,] 1.3439 0.01889  9.188
    ##  [4,] 1.6665 0.02313 10.849
    ##  [5,] 1.9361 0.02670 12.287
    ##  [6,] 2.1725 0.02985 13.574
    ##  [7,] 2.3855 0.03270 14.749
    ##  [8,] 2.5811 0.03532 15.837
    ##  [9,] 2.7628 0.03776 16.855
    ## [10,] 2.9333 0.04005 17.815
    ## [11,] 3.0944 0.04221 18.726
    ## [12,] 3.2476 0.04427 19.594

``` r
sVARMApred(m20, orig = 0, h =12 ) 
```

    ## Predictions at origin  400 
    ##    cpi imp_china   oil
    ##  257.1     4.620 65.85
    ##  258.3     4.635 68.89
    ##  257.8     4.660 68.18
    ##  258.5     4.672 68.35
    ##  258.6     4.693 67.94
    ##  258.7     4.706 68.61
    ##  258.7     4.680 66.40
    ##  256.6     4.673 55.84
    ##  256.8     4.641 49.69
    ##  257.9     4.572 53.60
    ##  259.4     4.598 58.47
    ##  260.5     4.668 60.50
    ## Standard errors of predictions 
    ##         resi    resi   resi
    ##  [1,] 0.4492 0.02821  4.136
    ##  [2,] 0.9110 0.03175  7.017
    ##  [3,] 1.2827 0.03387  9.483
    ##  [4,] 1.5776 0.03587 11.428
    ##  [5,] 1.8254 0.03776 13.087
    ##  [6,] 2.0434 0.03956 14.559
    ##  [7,] 2.2403 0.04128 15.894
    ##  [8,] 2.4212 0.04293 17.126
    ##  [9,] 2.5895 0.04452 18.275
    ## [10,] 2.7475 0.04606 19.356
    ## [11,] 2.8969 0.04755 20.379
    ## [12,] 3.0390 0.04899 21.354

``` r
sVARMApred(m28, orig = 0, h =12 )
```

    ## Predictions at origin  399 
    ##    cpi imp_china_ratio   oil
    ##  254.6          0.1737 59.82
    ##  255.9          0.1968 61.32
    ##  257.0          0.2007 64.95
    ##  256.4          0.2093 63.50
    ##  257.1          0.2107 63.79
    ##  257.2          0.2284 63.17
    ##  257.3          0.2134 64.22
    ##  257.3          0.2172 61.22
    ##  255.2          0.2242 51.43
    ##  255.6          0.2186 46.52
    ##  256.7          0.2125 50.28
    ##  258.4          0.2017 55.26
    ## Standard errors of predictions 
    ##         resi     resi   resi
    ##  [1,] 0.4521 0.005771  4.127
    ##  [2,] 0.9178 0.006641  6.996
    ##  [3,] 1.2780 0.007538  9.336
    ##  [4,] 1.5571 0.008340 11.197
    ##  [5,] 1.7932 0.009071 12.790
    ##  [6,] 2.0016 0.009747 14.205
    ##  [7,] 2.1903 0.010379 15.492
    ##  [8,] 2.3640 0.010975 16.680
    ##  [9,] 2.5258 0.011541 17.788
    ## [10,] 2.6778 0.012079 18.832
    ## [11,] 2.8217 0.012595 19.821
    ## [12,] 2.9585 0.013091 20.762
